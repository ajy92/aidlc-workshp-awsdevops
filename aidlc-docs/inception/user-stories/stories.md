# User Stories

User Journey 기반으로 구성. 고객 여정(입장→메뉴→장바구니→주문→확인)과 관리자 여정(로그인→모니터링→관리→분석) 순서.

---

## 고객 여정 (Customer Journey)

### US-C1: 테이블 자동 로그인
**As a** 식당 방문 고객,
**I want** 테이블에 앉으면 별도 로그인 없이 바로 주문 화면을 볼 수 있기를,
**So that** 대기 시간 없이 즉시 메뉴를 탐색하고 주문할 수 있다.

**Acceptance Criteria:**
1. **Given** 관리자가 태블릿에 매장ID/테이블번호/비밀번호를 1회 설정했을 때, **When** 태블릿을 켜면, **Then** 저장된 정보로 자동 로그인되어 메뉴 화면이 표시된다.
2. **Given** 자동 로그인이 성공했을 때, **When** 16시간이 경과하면, **Then** 세션이 만료되고 재로그인이 필요하다.
3. **Given** 저장된 로그인 정보가 없을 때, **When** 태블릿을 켜면, **Then** 매장ID/테이블번호/비밀번호 입력 화면이 표시된다.
4. **Given** 잘못된 비밀번호를 입력했을 때, **When** 로그인을 시도하면, **Then** 에러 메시지가 표시되고 재시도할 수 있다.

---

### US-C2: 메뉴 조회 및 카테고리 필터
**As a** 식당 방문 고객,
**I want** 카테고리별로 메뉴를 탐색하고 BEST/할인 메뉴를 쉽게 찾을 수 있기를,
**So that** 원하는 메뉴를 빠르게 찾아 선택할 수 있다.

**Acceptance Criteria:**
1. **Given** 로그인된 상태에서, **When** 메뉴 화면에 진입하면, **Then** 카테고리 필터 탭(메인메뉴, 사이드 메뉴, 음료, BEST, 할인)이 표시되고 판매중(ON_SALE) 메뉴만 노출된다.
2. **Given** 메뉴 목록이 표시될 때, **When** 카테고리 탭을 선택하면, **Then** 해당 카테고리의 메뉴만 필터링되어 표시된다. BEST/할인 탭은 플래그 기반 필터링.
3. **Given** 메뉴 카드가 표시될 때, **When** 메뉴를 확인하면, **Then** 메뉴명, 가격, 설명, 이미지가 카드 형태로 표시되며 버튼은 최소 44×44px이다.
4. **Given** 판매전(NOT_YET) 상태인 메뉴가 있을 때, **When** 고객이 메뉴를 조회하면, **Then** 해당 메뉴는 목록에 표시되지 않는다.

---

### US-C3: 장바구니 관리
**As a** 식당 방문 고객,
**I want** 주문 전에 선택한 메뉴를 확인하고 수량을 조절할 수 있기를,
**So that** 실수 없이 원하는 메뉴와 수량으로 주문할 수 있다.

**Acceptance Criteria:**
1. **Given** 메뉴 화면에서, **When** 메뉴 카드를 선택하면, **Then** 해당 메뉴가 장바구니에 추가되고 수량이 1 증가한다.
2. **Given** 장바구니에 메뉴가 있을 때, **When** 수량 증가/감소 버튼을 누르면, **Then** 수량이 변경되고 총 금액이 실시간으로 재계산된다. 수량 0이면 항목 삭제.
3. **Given** 장바구니에 메뉴가 있을 때, **When** 페이지를 새로고침하면, **Then** 장바구니 내용이 유지된다 (로컬 저장).
4. **Given** 장바구니 화면에서, **When** 장바구니 비우기를 선택하면, **Then** 모든 항목이 삭제되고 총 금액이 0원이 된다.

---

### US-C4: 주문 생성
**As a** 식당 방문 고객,
**I want** 장바구니의 메뉴를 확인하고 주문을 확정할 수 있기를,
**So that** 선택한 메뉴가 주방에 전달되어 음식을 받을 수 있다.

**Acceptance Criteria:**
1. **Given** 장바구니에 메뉴가 있을 때, **When** 주문하기 버튼을 누르면, **Then** 주문 내역(메뉴명, 수량, 단가, 총 금액)이 최종 확인 화면에 표시된다.
2. **Given** 최종 확인 화면에서, **When** 주문 확정을 누르면, **Then** 주문이 서버에 전송되고 주문 번호가 표시된다.
3. **Given** 주문이 성공했을 때, **When** 5초가 경과하면, **Then** 장바구니가 자동으로 비워지고 메뉴 화면으로 리다이렉트된다.
4. **Given** 주문 전송이 실패했을 때, **When** 에러가 발생하면, **Then** 에러 메시지가 표시되고 장바구니 내용은 유지된다.

---

### US-C5: 주문 내역 조회 (실시간 상태)
**As a** 식당 방문 고객,
**I want** 내가 주문한 내역과 현재 상태를 실시간으로 확인할 수 있기를,
**So that** 음식이 언제 나오는지 알 수 있다.

**Acceptance Criteria:**
1. **Given** 주문이 존재할 때, **When** 주문내역 탭을 선택하면, **Then** 현재 세션의 주문만 시간 역순으로 표시된다 (주문 번호, 시각, 메뉴/수량, 금액, 상태).
2. **Given** 주문 내역을 보고 있을 때, **When** 관리자가 주문 상태를 변경하면, **Then** SSE를 통해 실시간으로 상태가 업데이트된다 (대기중→준비중→완료).
3. **Given** 테이블 이용 완료 처리된 이전 세션의 주문이 있을 때, **When** 새 고객이 주문내역을 조회하면, **Then** 이전 세션의 주문은 표시되지 않는다.

---

## 관리자 여정 (Admin Journey)

### US-A1: 매장 인증
**As a** 매장 운영자,
**I want** 매장 관리 시스템에 안전하게 로그인할 수 있기를,
**So that** 권한이 있는 사람만 매장을 관리할 수 있다.

**Acceptance Criteria:**
1. **Given** 관리자 로그인 화면에서, **When** 매장ID/사용자명/비밀번호를 입력하고 로그인하면, **Then** JWT 토큰이 발급되고 대시보드로 이동한다.
2. **Given** 로그인된 상태에서, **When** 브라우저를 새로고침하면, **Then** 세션이 유지된다 (16시간 이내).
3. **Given** 16시간이 경과했을 때, **When** 페이지에 접근하면, **Then** 자동 로그아웃되고 로그인 화면으로 이동한다.
4. **Given** 잘못된 인증 정보를 입력했을 때, **When** 로그인을 시도하면, **Then** 에러 메시지가 표시되고 로그인 시도가 제한된다.

---

### US-A2: 실시간 주문 모니터링
**As a** 매장 운영자,
**I want** 들어오는 주문을 실시간으로 테이블별로 확인하고 상태를 변경할 수 있기를,
**So that** 주문을 놓치지 않고 효율적으로 처리할 수 있다.

**Acceptance Criteria:**
1. **Given** 대시보드에 접속했을 때, **When** 새 주문이 들어오면, **Then** SSE를 통해 2초 이내에 해당 테이블 카드에 주문이 표시되고 시각적으로 강조된다.
2. **Given** 테이블별 그리드가 표시될 때, **When** 각 테이블 카드를 확인하면, **Then** 테이블 번호, 총 주문액, 최신 주문 미리보기가 표시된다.
3. **Given** 주문 카드가 표시될 때, **When** 카드를 클릭하면, **Then** 전체 메뉴 목록 상세 보기가 표시된다.
4. **Given** 대기중 주문이 있을 때, **When** 상태 변경 버튼을 누르면, **Then** 대기중→준비중→완료 순서로 상태가 변경되고 고객에게 SSE로 전달된다.

---

### US-A3: 테이블 관리
**As a** 매장 운영자,
**I want** 테이블별 주문을 관리하고 이용 완료 처리를 할 수 있기를,
**So that** 테이블 회전을 효율적으로 관리하고 정확한 정산이 가능하다.

**Acceptance Criteria:**
1. **Given** 테이블에 주문이 있을 때, **When** 주문 삭제 버튼을 누르면, **Then** 확인 팝업이 표시되고 확인 시 주문이 삭제되며 총 주문액이 재계산된다.
2. **Given** 테이블에 활성 세션이 있을 때, **When** 이용 완료 버튼을 누르면, **Then** 확인 팝업 후 주문 내역이 과거 이력으로 이동하고 테이블이 리셋된다.
3. **Given** 이용 완료 처리된 테이블에, **When** 새 고객이 첫 주문을 하면, **Then** 새 세션이 시작되고 이전 주문 내역은 보이지 않는다.
4. **Given** 테이블 상세 화면에서, **When** 과거 내역 버튼을 누르면, **Then** 해당 테이블의 과거 주문 목록이 시간 역순으로 표시되고 날짜 필터링이 가능하다.

---

### US-A4: 메뉴 관리
**As a** 매장 운영자,
**I want** 메뉴를 등록/수정/삭제하고 상태와 태그를 관리할 수 있기를,
**So that** 매장 상황에 맞게 메뉴를 유연하게 운영할 수 있다.

**Acceptance Criteria:**
1. **Given** 메뉴 관리 화면에서, **When** 메뉴 추가를 선택하면, **Then** 메뉴명, 가격, 설명, 카테고리, 이미지 URL, 상태(판매중/판매전), BEST 플래그, 할인 플래그를 입력할 수 있다.
2. **Given** 메뉴를 등록할 때, **When** 필수 필드(메뉴명, 가격)가 비어있거나 가격이 범위를 벗어나면, **Then** 검증 에러가 표시되고 저장되지 않는다.
3. **Given** 기존 메뉴가 있을 때, **When** 수정 버튼을 누르면, **Then** 모든 필드를 수정할 수 있고 저장 시 즉시 반영된다.
4. **Given** 기존 메뉴가 있을 때, **When** 삭제 버튼을 누르면, **Then** 확인 팝업 후 메뉴가 삭제되고 고객 화면에서도 즉시 사라진다.
5. **Given** 메뉴 상태를 판매전(NOT_YET)으로 변경했을 때, **When** 고객이 메뉴를 조회하면, **Then** 해당 메뉴는 고객 화면에 노출되지 않는다.

---

### US-A5: 대시보드 (매출 데이터 & 고객 분석)
**As a** 매장 운영자,
**I want** 매출 현황과 고객 분석 데이터를 시각적으로 확인할 수 있기를,
**So that** 데이터 기반으로 매장 운영 전략을 수립할 수 있다.

**Acceptance Criteria:**
1. **Given** 대시보드에 접속했을 때, **When** 매출 탭을 선택하면, **Then** 일별/주별/월별 매출 합계, 주문 건수, 평균 객단가가 차트로 표시된다.
2. **Given** 매출 데이터가 표시될 때, **When** 날짜 범위를 변경하면, **Then** 해당 기간의 테이블별 매출, 메뉴별 판매 순위, 시간대별 주문 분포, 카테고리별 매출 비중이 업데이트된다.
3. **Given** 매출 데이터가 표시될 때, **When** 기간 비교를 선택하면, **Then** 전일/전주/전월 대비 매출 증감이 표시된다.
4. **Given** 고객 분석 탭을 선택했을 때, **When** 데이터를 확인하면, **Then** 고객 방문 빈도(세션 기반)와 재방문율이 표시된다.
